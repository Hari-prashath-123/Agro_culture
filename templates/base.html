<!DOCTYPE html>
<html>
<head>
    <title>Agro Culture System</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <nav class="navbar">
        <a href="/" class="navbar-brand">
            <img src="/static/images/logo.jpg" alt="Agro Culture" class="navbar-logo"> Agro Culture
        </a>
        
        <ul class="navbar-menu">
            {% if user.is_authenticated %}
                {% if user.userprofile.role == 'Admin' %}
                    <li><a href="{% url 'admin_summary' %}">Management Dashboard</a></li>
                {% endif %}
                <li class="notification-container">
                    <a href="{% url 'notifications' %}" class="notification-bell">
                        ðŸ””
                        <span class="notification-badge" id="notificationBadge" style="display:none;"></span>
                    </a>
                </li>
                <li><a href="{% url 'logout' %}">Logout</a></li>
            {% else %}
                <li><a href="{% url 'login' %}">Login</a></li>
                <li><a href="{% url 'register' %}">Register</a></li>
            {% endif %}
        </ul>
    </nav>
    <div class="container">
        {% block content %}{% endblock %}
    </div>
    
    {% if user.is_authenticated %}
    <script>
    // Check for unread notifications
    function updateNotificationCount() {
        fetch('/get_notification_count/')
            .then(response => response.json())
            .then(data => {
                const badge = document.getElementById('notificationBadge');
                if (data.unread_count > 0) {
                    badge.textContent = data.unread_count;
                    badge.style.display = 'block';
                } else {
                    badge.style.display = 'none';
                }
            })
            .catch(error => console.error('Error:', error));
    }
    
    // Update count on page load
    updateNotificationCount();
    
    // Update count every 30 seconds
    setInterval(updateNotificationCount, 30000);
    </script>
    {% endif %}
</body>
</html>
